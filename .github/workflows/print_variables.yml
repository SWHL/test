name: Release

on:
  push:
    tags:
    - Desktop-v*

jobs:
  release:
    name: Create Release
    runs-on: ubuntu-latest

    steps:
    - name: Pull latest code
      uses: actions/checkout@v3

    - name: Print tag info
      run: |
        mv ui/* .
        py_path="RapidVideOCR.py"
        txt_path="RapidVideOCR.txt"
        mv $py_path $txt_path
        line_num=$(sed -n "/self.version = /=" $txt_path)
        new_version=${{ github.ref_name }}
        sed -i '37s/        self.version = "v0.0.4"/        self.version = "$new_version"/g' $txt_path
        mv $txt_path $py_path
        echo "VERSION=0.0.4" >> $GITHUB_OUTPUT
        echo $(grep -n 'self.version = ' $py_path)
