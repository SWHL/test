name: Release

on:
  push:
    tags:
    - Desktop-v*

jobs:
  release:
    name: Create Release
    runs-on: ubuntu-latest

    steps:
    - name: Pull latest code
      uses: actions/checkout@v3

    - name: Print tag info
      run: |
        mv ui/* .
        mv RapidVideOCR.py RapidVideOCR.txt
        line_num=$(sed -n "/self.version = /=" RapidVideOCR.txt)
        new_version=${{ github.ref_name }}
        sed -i '37s/        self.version = "v0.0.4"/        self.version = "$new_version"/g' RapidVideOCR.txt
        mv RapidVideOCR.txt RapidVideOCR.py
        echo "VERSION=0.0.4" >> $GITHUB_OUTPUT
        echo $(grep -n 'self.version = ' RapidVideOCR.txt)
